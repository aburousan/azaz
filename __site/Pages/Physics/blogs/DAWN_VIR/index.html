<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.4 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/libs/highlight/styles/github.min.css">
   
  <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/minimal-mistakes.css">
<link rel="stylesheet" href="/css/adjust.css">
<link rel="icon" href="/assets/favicon.jpg">
<!--[if IE ]>
<style>
  /* old IE unsupported flexbox fixes */
  .greedy-nav .site-title {
    padding-right: 3em;
  }
  .greedy-nav button {
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
  }
</style>
<![endif]-->

   <title>virtools: A tool for radiometric calibration of DAWN VIR data</title>  
  <!-- end custom head snippets -->
</head>
<body class="layout--single">
  <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Azazaya</a>
        <ul class="visible-links">
          <li class="masthead__menu-item"><a href="/home_page/" >Home</a></li>
          <li class="masthead__menu-item"><a href="/Pages/Maths/Maths_Home/" >Maths Home</a></li>
          <li class="masthead__menu-item"><a href="/Pages/Physics/Physics_Home/" >Physics Home</a></li>
          <li class="masthead__menu-item"><a href="/Pages/Tags_page">Tags</a></li>
        </ul>
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

  <div class="initial-content">
    <div id="main" role="main">
      <div class="sidebar sticky">
        <div itemscope itemtype="https://schema.org/Person">
          <div class="author__avatar">
            <img src="/assets/minimal-mistakes/Rousan.jpeg" alt="Septimia Zenobia" itemprop="image">
          </div>
          <div class="author__content">
            <h3 class="author__name" itemprop="name">Kazi Abu Rousan</h3>
            <p class="author__bio" itemprop="description">Just some random dude.</p>
          </div>
          <div class="author__urls-wrapper">
            <button class="btn btn--inverse">Follow</button>
            <ul class="author__urls social-icons">
              <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
                <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Murshidabad, India</span></li>
                <li><a href="https://www.instagram.com/azavzya/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
              <li><a href="https://www.linkedin.com/in/kazi-abu-rousan-819848198/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
            </ul>
          </div>
        </div>
      </div>

<!-- Content appended here -->


  <script src="/libs/plotly/plotly.min.js"></script> 
  <script>
    // This function is used when calling `\fig{...}` See # Using \fig{...} below
    const PlotlyJS_json = async (div, url) => {
      response = await fetch(url); // get file
      fig = await response.json(); // convert it to json
      // Make the plot fit the screen responsively. See the documentation of plotly.js. https://plotly.com/javascript/responsive-fluid-layout/
      if (typeof fig.config === 'undefined') { fig["config"]={} }
      delete fig.layout.width
      delete fig.layout.height
      fig["layout"]["autosize"] = true
      fig["config"]["autosizable"] = true
      fig["config"]["responsive"] = true

      // make it easier to scroll throught the website rather than being blocked by a figure.
      fig.config["scrollZoom"] = false

      // PlotlyJS.savefig by default add the some more attribute to make a static plot.
      // Disable them to make the website fancier.
      delete fig.config.staticPlot
      delete fig.config.displayModeBar
      delete fig.config.doubleClick
      delete fig.config.showTips

      Plotly.newPlot(div, fig);
    };
  </script>
  


  <script src="/libs/clipboard.min.js"></script><div class="franklin-content">
<div class="franklin-toc"><ol><li><a href="#introduction_to_the_data_and_its_format">Introduction to the Data and it&#39;s format</a></li><li><a href="#setting_up_the_package">Setting up the package:</a></li><li><a href="#importing_the_data">Importing the data:</a></li><li><a href="#calibration">Calibration</a></li></ol></div>
<h1 id="virtools_a_tool_for_radiometric_calibration_of_dawn_vir_data"><a href="#virtools_a_tool_for_radiometric_calibration_of_dawn_vir_data" class="header-anchor">virtools: A tool for Radiometric Calibration of DAWN VIR data</a></h1>
<p>The  <strong><span style="color: purple">DAWN VIR</span></strong> Calibration Package is essential for transforming raw data collected by the Visible and Infrared Spectrometer &#40;VIR&#41; onboard NASA&#39;s DAWN spacecraft into scientifically meaningful and physically accurate measurements.</p>
<p>The VIR instrument, which observed planetary bodies like Vesta and Ceres, records radiance data in <strong><span style="color: red">digital numbers &#40;DN&#41;</span></strong> that are affected by various instrumental and environmental artifacts. These include detector noise, dark current, stray light, bad pixels, spectral misalignments, and radiometric inconsistencies.</p>
<p>Without calibration, the raw data from VIR are not directly usable for scientific analysis, as they do not accurately represent the <strong><span style="color: blue">surface reflectance of the observed bodies</span></strong>.</p>
<p>The calibration package provides a suite of algorithms and correction procedures‚Äîoften derived from both pre-flight laboratory characterizations and in-flight observations‚Äîthat convert these raw measurements into radiometrically calibrated, artifact-corrected data products. These are suitable for applications such as mineralogical mapping, thermal modeling, surface composition studies, and planetary geophysics.</p>
<p>In short, <strong>the calibration package is a critical preprocessing step that ensures data fidelity, enabling reliable interpretation of planetary surfaces and supporting high-quality scientific research.</strong></p>
<p>‚ÄìWith calibrated sight and spectral flame, We cut through the lies that corrupt the light. Stand tall, like a Hashira of knowledge‚Äî Power up‚Ä¶ and let this cosmic battle begin&#33;</p>

  <fieldset class=" poem"><legend class=" poem-legend"> ü™∂ Poem</legend>
      <strong>Through Vesta‚Äôs glow and Ceres‚Äô shade,<br/> The VIR spectrometer softly played.<br/> But raw the light, not clean nor bright,<br/> Masked by noise that veils the sight.<br/> <br/> Dark current flowed beneath each scan,<br/> Artifacts danced where truth began.<br/> Odd-even shifts broke spectral grace,<br/> And radiance lost its rightful place.<br/> <br/> Yet code arose, both sharp and wise,<br/> To lift the veil from distant skies.<br/> Corrected spectra, clear and grand,<br/> Revealed the story in rock and sand.<br/> <br/> Now calibrated, pure and wide,<br/> The data sings of time and tide.<br/> In every cube, a tale made right‚Äî<br/> A world reborn in measured light.<br/> <br/> But the path ahead extends afar,<br/> Each fix a step, not final star.<br/> No end to truth, no perfect scheme‚Äî<br/> Just clearer maps of a deeper dream.<br/> <br/> So start with code both clear and small,<br/> Though simple, it may yet reveal all.<br/> For in this sea without a shore,<br/> Each better answer calls for more.</strong></p>
<p>‚ÄìK.A.Rousan 
  </fieldset>
  

  <fieldset class=" note"><legend class=" note-legend"> üìù Note</legend>
      virtools is a python-package developed by myself. To use download it from <a href="https://github.com/aburousan/virtools">github</a> or follow this blog. 
  </fieldset>
  
<h2 id="introduction_to_the_data_and_its_format"><a href="#introduction_to_the_data_and_its_format" class="header-anchor">Introduction to the Data and it&#39;s format</a></h2>
<p>To use the package, we first have to know what is the data we are working with. <strong><span style="color: red">VIR</span></strong> actually uses the pushbroom method to capture images of the ceres surface in different wavelengths. 
<div class="row">
  <div class="container">
    <div style="display: flex; flex-wrap: wrap; justify-content: space-between;">
      <img class="plot" src="/assets/Physics/blogs/virtools_blog/push_broom.png" style="max-width: 48%; height: auto;">
      <img class="plot" src="/assets/Physics/blogs/virtools_blog/hyper_spec.png" style="max-width: 48%; height: auto;">
    </div>
    <div style="clear: both;"></div>      
  </div>
</div>
 The left image is a diagram to show pushbroom method. There, we can see a detector array. This array actually take a image along it&#39;s length and then it is moved in a direction perpendicular to it&#39;s length giving us the image of the surface. The detector has many small detectors&#40;pixels&#41;. Those are called <strong><span style="color: purple">samples</span></strong>. This value is obviously fixed &#40;\(s=256\)&#41;. As the detector moves, it takes images. Each of these are called <strong><span style="color: purple">lines</span></strong> &#40;in the diagram the rectangular patches on ground&#41;. This number is not constant, it can vary data file to data file.</p>
<p>The data is stored for \(b=432\) different wavelengths, i.e., the image is taken for \(432\) different wavelengths. We can think the data as different images &#40;sample &amp; line&#41; for different wavelengths stacked together. So, the image is sort of like <strong><span style="color: red">cube</span></strong> as shown in the previous image. One axis is <strong><span style="color: blue">band axis</span></strong>, one is <strong><span style="color: blue">sample axis</span></strong> and other is <strong><span style="color: blue">sample axis</span></strong>. So, if I store the cube file data as an numpy array <code>C</code>, then <code>C&#91;b,s,l&#93;</code> represent the value of data for band no. \(b\), sample no. \(s\) and line no. \(l\).</p>
<table><tr><th align="right">Type</th><th align="right">Called</th></tr><tr><td align="right">For fixed band <code>C&#91;b,:,:&#93;</code></td><td align="right">Image</td></tr><tr><td align="right">For fixed sample <code>C&#91;:,s,:&#93;</code></td><td align="right">Slice</td></tr><tr><td align="right">For fixed line <code>C&#91;:,:,l&#93;</code></td><td align="right">Frame</td></tr></table>
<p>When the device takes the data, It generates \(4\) files:</p>
<ol>
<li><p>.LBL file : This contains info about device name, target name, wavelengths, band index, SPICE file details, distance from sun and all other things. An example of the file is here.</p>
</li>
</ol>
<pre><code class="language-txt">PDS_VERSION_ID &#61; PDS3                                                         
LABEL_REVISION_NOTE &#61; &quot;MTC_11-10-2011&quot;                                        
                                                                              
/* Dataset and Product Information */                                         
DATA_SET_NAME &#61; &quot;DAWN VIR RAW &#40;EDR&#41; CERES INFRARED SPECTRA V1.0&quot;              
DATA_SET_ID &#61; &quot;DAWN-A-VIR-2-EDR-IR-CERES-SPECTRA-V1.0&quot;                        
PRODUCT_ID &#61; &quot;VIR_IR_1A_1_493156585&quot;                                          
PRODUCT_TYPE &#61; EDR                                                            
PRODUCER_FULL_NAME &#61; &quot;M. C. DE SANCTIS&quot;                                       
PRODUCER_INSTITUTION_NAME &#61; &quot;ISTITUTO NAZIONALE DI ASTROFISICA&quot;               
PRODUCT_CREATION_TIME &#61; 2016-10-13T19:33:39.186                               
PRODUCT_VERSION_ID &#61; &quot;01&quot;                                                     
                                                                              
/* File Information */                                                        
RECORD_TYPE &#61; FIXED_LENGTH                                                    
RECORD_BYTES &#61; 512                                                            
FILE_RECORDS &#61; 15120                                                          
LABEL_RECORDS &#61; 46                                                            
                                                                              
/* Time Information */                                                        
START_TIME &#61; 2015-08-18T07:55:19.569                                          
STOP_TIME &#61; 2015-08-18T08:07:59.799                                           
IMAGE_MID_TIME &#61; 2015-08-18T08:01:39.684                                      
SPACECRAFT_CLOCK_START_COUNT &#61; &quot;1/493156585.1098&quot;                             
SPACECRAFT_CLOCK_STOP_COUNT &#61; &quot;1/493157346.7980&quot;                              
                                                                              
/* Mission description parameters */                                          
INSTRUMENT_HOST_NAME &#61; &quot;DAWN&quot;                                                 
INSTRUMENT_HOST_ID &#61; &quot;DAWN&quot;                                                   
MISSION_PHASE_NAME &#61; &quot;CERES SCIENCE HAMO &#40;CSH&#41;&quot;                               
                                                                              
/* Instrument description parameters */                                       
INSTRUMENT_NAME &#61; &quot;VISIBLE AND INFRARED SPECTROMETER&quot;                         
INSTRUMENT_ID &#61; &quot;VIR&quot;                                                         
INSTRUMENT_TYPE &#61; &quot;IMAGING SPECTROMETER&quot;                                      
                                                                              
/* Celestial Geometry                                       */                
RIGHT_ASCENSION                  &#61;  279.965 &lt;degrees&gt;                         
DECLINATION                      &#61;  -62.231 &lt;degrees&gt;                         
TWIST_ANGLE                      &#61;  227.917 &lt;degrees&gt;                         
CELESTIAL_NORTH_CLOCK_ANGLE      &#61;  312.083 &lt;degrees&gt;                         
QUATERNION                       &#61; &#40;  0.11612,                                
                                     -0.31567,                                
                                     -0.91802,                                
                                      0.21000 &#41;                               
QUATERNION_DESC                  &#61; &quot;                                          
     Above parameters are calculated at the center time of the observation    
     which is 2015-08-18T08:01:39.684.  The quaternion has the form:          
     w, x, y, z &#40;i.e. SPICE format&#41;.&quot;                                         
                                                                              
/* Solar geometry                                          */                 
SPACECRAFT_SOLAR_DISTANCE        &#61;   441765162.5 &lt;km&gt;                         
SC_SUN_POSITION_VECTOR           &#61; &#40; -259675440.2 &lt;km&gt;,                       
                                      299958230.3 &lt;km&gt;,                       
                                      194294067.4 &lt;km&gt; &#41;                      
                                                                              
SC_SUN_VELOCITY_VECTOR           &#61; &#40; -13.502 &lt;km/s&gt;,                          
                                      -9.829 &lt;km/s&gt;,                          
                                      -1.718 &lt;km/s&gt; &#41;                         
                                                                              
/* SPICE Kernels                                            */                
SPICE_FILE_NAME                  &#61; &quot;DAWN_CSH_R01.TM&quot;                          
                                                                              
TARGET_NAME                      &#61; &quot;CAL LAMP&quot;                                 
TARGET_TYPE                      &#61; &quot;CALIBRATION&quot;                              
                                                                              
/* COORDINATE SYSTEM                                        */                
COORDINATE_SYSTEM_NAME           &#61; &quot;N/A&quot;                                      
COORDINATE_SYSTEM_CENTER_NAME    &#61; &quot;N/A&quot;                                      
                                                                              
/* Geometry in &quot;IAU_VESTA&quot; coordinates from SPICE         */                  
SUB_SPACECRAFT_LATITUDE          &#61; &quot;N/A&quot;                                      
SUB_SPACECRAFT_LONGITUDE         &#61; &quot;N/A&quot;                                      
SUB_SPACECRAFT_AZIMUTH           &#61; &quot;N/A&quot;                                      
SPACECRAFT_ALTITUDE              &#61; &quot;N/A&quot;                                      
TARGET_CENTER_DISTANCE           &#61; &quot;N/A&quot;                                      
SC_TARGET_POSITION_VECTOR        &#61; &#40; &quot;N/A&quot;,                                   
                                     &quot;N/A&quot;,                                   
                                     &quot;N/A&quot; &#41;                                  
                                                                              
SC_TARGET_VELOCITY_VECTOR        &#61; &#40; &quot;N/A&quot;,                                   
                                     &quot;N/A&quot;,                                   
                                     &quot;N/A&quot; &#41;                                  
                                                                              
LOCAL_HOUR_ANGLE                 &#61; &quot;N/A&quot;                                      
SUB_SOLAR_LATITUDE               &#61; &quot;N/A&quot;                                      
SUB_SOLAR_LONGITUDE              &#61; &quot;N/A&quot;                                      
SUB_SOLAR_AZIMUTH                &#61; &quot;N/A&quot;                                      
                                                                              
/* Illumination                                             */                
INCIDENCE_ANGLE                  &#61; &quot;N/A&quot;                                      
EMISSION_ANGLE                   &#61; &quot;N/A&quot;                                      
PHASE_ANGLE                      &#61; &quot;N/A&quot;                                      
                                                                              
/* Image parameters                                         */                
SLANT_DISTANCE                   &#61; &quot;N/A&quot;                                      
MINIMUM_LATITUDE                 &#61; &quot;N/A&quot;                                      
CENTER_LATITUDE                  &#61; &quot;N/A&quot;                                      
MAXIMUM_LATITUDE                 &#61; &quot;N/A&quot;                                      
WESTERNMOST_LONGITUDE            &#61; &quot;N/A&quot;                                      
CENTER_LONGITUDE                 &#61; &quot;N/A&quot;                                      
EASTERNMOST_LONGITUDE            &#61; &quot;N/A&quot;                                      
HORIZONTAL_PIXEL_SCALE           &#61; &quot;N/A&quot;                                      
VERTICAL_PIXEL_SCALE             &#61; &quot;N/A&quot;                                      
NORTH_AZIMUTH                    &#61; &quot;N/A&quot;                                      
ORBIT_NUMBER                     &#61; &quot;N/A&quot;                                      
                                                                              
/* Data description parameters */                                             
PROCESSING_LEVEL_ID &#61; &quot;2&quot;                                                     
DATA_QUALITY_ID &#61; &quot;1&quot;                                                         
DATA_QUALITY_DESC &#61; &quot;0:INCOMPLETE; 1:COMPLETE&quot;                                
TELEMETRY_SOURCE_ID &#61; &quot;EGSE&quot;                                                  
CHANNEL_ID &#61; &quot;IR&quot;                                                             
SOFTWARE_VERSION_ID &#61; &quot;EGSE V1.14,AMDLSpace&quot;                                  
                                                                              
/* Instrument status */                                                       
INSTRUMENT_MODE_ID &#61; &quot;C_H_SPE_H_SPA_F&quot;                                        
INSTRUMENT_MODE_DESC &#61;                                                        
 &quot;S_H_SPE_H_SPA_F: Science, high spectral high spatial, Full slit             
  S_H_SPE_L_SPA_F: Science, high spectral low spatial, Full slit              
  S_H_SPE_L_SPA_F_SUM: Science, high spectral low spatial, Summing            
  S_L_SPE_H_SPA_F: Science, Low spectral high spatial, Full slit              
  S_L_SPE_L_SPA_F: Science, Low spectral low spatial, Full slit               
  S_L_SPE_L_SPA_F_SUM: Science, Low spectral low spatial, Summing             
  S_H_SPE_H_SPA_Q: Science, high spectral high spatial, Quarter slit          
  S_L_SPE_H_SPA_Q: Science, low spectral high spatial, Quarter slit           
  S_H_SPE_L_SPA_F_MEA: Science, high spectral low spatial, Meaning            
  S_L_SPE_L_SPA_F_MEA: Science, low spectral low spatial, Meaning             
  C_H_SPE_H_SPA_F: Calibration, high spectral high spatial, Full slit         
  C_H_SPE_L_SPA_F: Calibration, high spectral low spatial, Full slit          
  SPARE: CALIBRATION Spare                                                    
  C_L_SPE_H_SPA_F: Calibration, low spectral high spatial, Full slit          
  C_L_SPE_L_SPA_F: Calibration, low spectral low spatial, Full slit           
  C_H_SPE_H_SPA_Q: Calibration, high spectral high spatial, Quarter slit      
  C_L_SPE_H_SPA_Q: Calibration, low spectral high spatial, Quarter slit&quot;      
ENCODING_TYPE &#61; &quot;N/A&quot;                                                         
SCAN_MODE_ID &#61; &quot;5&quot;                                                            
DAWN:SCAN_PARAMETER &#61; &#40;0.1, 0.1, 0.26, 25&#41;                                    
SCAN_PARAMETER_DESC &#61; &#40;&quot;SCAN_START_ANGLE&quot;, &quot;SCAN_STOP_ANGLE&quot;,                 
 &quot;SCAN_STEP_ANGLE&quot;,&quot;SCAN_STEP_NUMBER&quot;&#41;                                        
DAWN:SCAN_PARAMETER_UNIT &#61; &#40;&quot;DEGREES&quot;, &quot;DEGREES&quot;, &quot;DEGREES&quot;, &quot;DIMENSIONLESS&quot;&#41; 
FRAME_PARAMETER &#61; &#40;0.0, 1, 20, 0&#41;                                             
FRAME_PARAMETER_DESC &#61; &#40;&quot;EXPOSURE_DURATION&quot;, &quot;FRAME_SUMMING&quot;,                 
&quot;EXTERNAL_REPETITION_TIME&quot;, &quot;DARK_ACQUISITION_RATE&quot;&#41;                          
DAWN:FRAME_PARAMETER_UNIT &#61; &#40;&quot;S&quot;, &quot;DIMENSIONLESS&quot;, &quot;S&quot;, &quot;DIMENSIONLESS&quot;&#41;      
DAWN:VIR_IR_START_X_POSITION&#61;0                                                
DAWN:VIR_IR_START_Y_POSITION&#61;0                                                
MAXIMUM_INSTRUMENT_TEMPERATURE &#61; &#40;84.5, 135.6, 136.6, 79.0&#41;                   
INSTRUMENT_TEMPERATURE_POINT &#61; &#40;&quot;FOCAL_PLANE&quot;, &quot;TELESCOPE&quot;, &quot;SPECTROMETER&quot;,   
&quot;CRYOCOOLER&quot;&#41;                                                                 
DAWN:INSTRUMENT_TEMPERATURE_UNIT &#61; &#40;&quot;K&quot;, &quot;K&quot;, &quot;K&quot;, &quot;K&quot;&#41;                       
PHOTOMETRIC_CORRECTION_TYPE &#61; &quot;NONE&quot;                                          
                                                                              
/* Pointers to first record of objects in file */                             
^HISTORY &#61; 48                                                                 
OBJECT &#61; HISTORY                                                              
END_OBJECT &#61; HISTORY                                                          
^QUBE &#61; &quot;VIR_IR_1A_1_493156585_1.QUB&quot;                                         
                                                                              
/* Description of the object contained in the file */                         
OBJECT &#61; QUBE                                                                 
                                                                              
/*    Standard cube Keywords */                                               
 AXES &#61; 3                                                                     
 AXIS_NAME &#61; &#40;BAND, SAMPLE, LINE&#41;                                             
 CORE_ITEMS &#61; &#40; 432, 256, 35 &#41;                                                
 CORE_ITEM_BYTES &#61; 2                                                          
 CORE_ITEM_TYPE &#61; MSB_INTEGER                                                 
 CORE_BASE &#61; 0.0                                                              
 CORE_MULTIPLIER &#61; 1.0                                                        
 CORE_VALID_MINIMUM &#61; 0                                                       
 CORE_NULL &#61; -32768                                                           
 CORE_LOW_REPR_SATURATION &#61; -32767                                            
 CORE_LOW_INSTR_SATURATION &#61; -32767                                           
 CORE_HIGH_REPR_SATURATION &#61; -32767                                           
 CORE_HIGH_INSTR_SATURATION &#61; -32767                                          
 CORE_NAME &#61; &quot;RAW DATA NUMBER&quot;                                                
 CORE_UNIT &#61; DIMENSIONLESS                                                    
                                                                              
/*  Suffix definition */                                                      
 SUFFIX_BYTES &#61; 4                                                             
 SUFFIX_ITEMS &#61; &#40;    0,   0,    0&#41;                                            
                                                                              
/* Spectral axis description */                                               
                                                                              
    GROUP &#61; BAND_BIN                                                          
                                                                              
    BAND_BIN_CENTER &#61;                                                         
&#40;1.021,1.030,1.040,1.049,1.059,....&#41;
 BAND_BIN_WIDTH  &#61;                                                       
&#40;0.0140,0.0140,0.0140,0.0140,......&#41;
BAND_BIN_UNIT &#61; MICROMETER                                                   
                                                                              
    BAND_BIN_ORIGINAL_BAND &#61;                                                  
&#40;1,2,3,4,5,6,7,8,9,10,11,12,.......&#41;
END_GROUP &#61; BAND_BIN                                                          
                                                                              
END_OBJECT                     &#61; QUBE                                         
END                                                                           
                                                                              
OBJECT &#61; HISTORY                                                              

END_OBJECT &#61; HISTORY</code></pre>
<ol start="2">
<li><p>.QUB file: This contains the actual data. This stores the image as <strong><span style="color: red">Digital Number</span></strong> as normally happens for CCD type devices. This is the data we have to convert in radinace or reflectance. We can&#39;t directly open this data &#40;so can&#39;t show you here&#41;.</p>
</li>
<li><p>HK_.LBL file: This contains the column names for the other data file of detail information of the device like temperature of detector, temp of spectroscope, shutter status, exposure time for each lines.</p>
</li>
</ol>
<pre><code class="language-txt">PDS_VERSION_ID                &#61; &quot;PDS3&quot;                                        
DATA_SET_ID                   &#61; &quot;DAWN-A-VIR-2-EDR-IR-CERES-SPECTRA-V1.0&quot;      
PRODUCT_ID                    &#61; &quot;VIR_IR_1A_1_493156585_HK&quot;                    
PRODUCT_TYPE                  &#61; &quot;ENGINEERING_DATA&quot;                            
PRODUCT_VERSION_ID            &#61; &quot;01&quot;                                          
PRODUCT_CREATION_TIME         &#61; 2016-10-13T19:33:39.186                       
                                                                              
RECORD_TYPE                   &#61; FIXED_LENGTH                                  
RECORD_BYTES                  &#61; 288                                           
FILE_RECORDS                  &#61; 35                                            
                                                                              
START_TIME                    &#61; 2015-08-18T07:55:19.569                       
STOP_TIME                     &#61; 2015-08-18T08:07:59.799                       
SPACECRAFT_CLOCK_START_COUNT  &#61; &quot;1/493156585.1098&quot;                            
SPACECRAFT_CLOCK_STOP_COUNT   &#61; &quot;1/493157346.7980&quot;                            
                                                                              
INSTRUMENT_HOST_NAME          &#61; &quot;DAWN&quot;                                        
INSTRUMENT_HOST_ID            &#61; &quot;DAWN&quot;                                        
MISSION_PHASE_NAME            &#61; &quot;CERES SCIENCE HAMO &#40;CSH&#41;&quot;                    
TARGET_NAME                   &#61; &quot;CAL LAMP&quot;                                    
INSTRUMENT_NAME               &#61; &quot;VISIBLE AND INFRARED SPECTROMETER&quot;           
INSTRUMENT_ID                 &#61; &quot;VIR&quot;                                         
DESCRIPTION                   &#61; &quot;&quot;                                            
                                                                              
^TABLE                        &#61; &quot;VIR_IR_1A_1_493156585_HK_1.TAB&quot;              
OBJECT                        &#61; TABLE                                         
  INTERCHANGE_FORMAT          &#61; ASCII                                         
  ROWS                        &#61; 35                                            
  COLUMNS                     &#61; 33                                            
  ROW_BYTES                   &#61; 288                                           
  DESCRIPTION                 &#61; &quot;&quot;                                            
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;VERSION, TYPE, SECONDARY HEADER FLAG&quot;        
    COLUMN_NUMBER             &#61; 1                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 1                                             
    BYTES                     &#61; 2                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;APID&quot;                                        
    COLUMN_NUMBER             &#61; 2                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 4                                             
    BYTES                     &#61; 3                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;PACKET SEQUENCE CONTROL&quot;                     
    COLUMN_NUMBER             &#61; 3                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 8                                             
    BYTES                     &#61; 5                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;PACKETS LENGTH&quot;                              
    COLUMN_NUMBER             &#61; 4                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 14                                            
    BYTES                     &#61; 4                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;SCET TIME &#40;CLOCK&#41;&quot;                           
    COLUMN_NUMBER             &#61; 5                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_REAL                                    
    START_BYTE                &#61; 19                                            
    BYTES                     &#61; 12                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;FRAME NUMBER&quot;                                
    COLUMN_NUMBER             &#61; 6                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 34                                            
    BYTES                     &#61; 3                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;FRAME COUNT&quot;                                 
    COLUMN_NUMBER             &#61; 7                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 38                                            
    BYTES                     &#61; 3                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;SUBFRAME COUNT&quot;                              
    COLUMN_NUMBER             &#61; 8                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 42                                            
    BYTES                     &#61; 2                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;PACKETS COUNT&quot;                               
    COLUMN_NUMBER             &#61; 9                                             
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; ASCII_INTEGER                                 
    START_BYTE                &#61; 45                                            
    BYTES                     &#61; 2                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;SHUTTER STATUS&quot;                              
    COLUMN_NUMBER             &#61; 10                                            
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; CHARACTER                                     
    START_BYTE                &#61; 48                                            
    BYTES                     &#61; 8                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;CHANNEL ID&quot;                                  
    COLUMN_NUMBER             &#61; 11                                            
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; CHARACTER                                     
    START_BYTE                &#61; 57                                            
    BYTES                     &#61; 3                                             
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;COMPRESSION MODE&quot;                            
    COLUMN_NUMBER             &#61; 12                                            
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; CHARACTER                                     
    START_BYTE                &#61; 61                                            
    BYTES                     &#61; 20                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;SPECTRAL RANGE&quot;                              
    COLUMN_NUMBER             &#61; 13                                            
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; CHARACTER                                     
    START_BYTE                &#61; 82                                            
    BYTES                     &#61; 24                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;CURRENT MODE&quot;                                
    COLUMN_NUMBER             &#61; 14                                            
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; CHARACTER                                     
    START_BYTE                &#61; 107                                           
    BYTES                     &#61; 12                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;CURRENT SUBMODE&quot;                             
    COLUMN_NUMBER             &#61; 15                                            
    UNIT                      &#61; &quot;N/A&quot;                                         
    DATA_TYPE                 &#61; CHARACTER                                     
    START_BYTE                &#61; 120                                           
    BYTES                     &#61; 14                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;IR EXPO&quot;                                     
    COLUMN_NUMBER             &#61; 16                                            
    UNIT                      &#61; &quot;S&quot;                                           
    DATA_TYPE                 &#61; ASCII_REAL                                    
    START_BYTE                &#61; 135                                           
    BYTES                     &#61; 10                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;IR TEMP&quot;                                     
    COLUMN_NUMBER             &#61; 17                                            
    UNIT                      &#61; &quot;K&quot;                                           
    DATA_TYPE                 &#61; ASCII_REAL                                    
    START_BYTE                &#61; 146                                           
    BYTES                     &#61; 10                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;CCD EXPO&quot;                                    
    COLUMN_NUMBER             &#61; 18                                            
    UNIT                      &#61; &quot;S&quot;                                           
    DATA_TYPE                 &#61; ASCII_REAL                                    
    START_BYTE                &#61; 157                                           
    BYTES                     &#61; 10                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN                                        
                                                                              
  OBJECT                      &#61; COLUMN                                        
    NAME                      &#61; &quot;CCD TEMP&quot;                                    
    COLUMN_NUMBER             &#61; 19                                            
    UNIT                      &#61; &quot;K&quot;                                           
    DATA_TYPE                 &#61; ASCII_REAL                                    
    START_BYTE                &#61; 168                                           
    BYTES                     &#61; 10                                            
    DESCRIPTION               &#61; &quot;&quot;                                            
  END_OBJECT                  &#61; COLUMN</code></pre>
<ol start="4">
<li><p>HK<em>.TAB file: This contains the data corresponding to the table names in the previous HK</em>.LBL file. It looks like,</p>
</li>
</ol>
<pre><code class="language-txt">8 102     0 1017 493156585.1020   5   1  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.000000  84.482243   0.000000 170.251659   0.066178   0.997557 135.007163 137.163745  77.109671 140.777476   0.007059 142.686342  0  0  0  0  9216  1
 8 102   456 1017 493156605.1000   5   2  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.000000  84.482243   0.000000 170.251659   0.066178   0.997557 135.065449 137.192888  77.672624 140.762904   0.007071 142.700913  0  0  0  0  9216  1
 8 102   912 1017 493156625.1000   5   3  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.000000  84.482243   0.000000 170.222171   0.066178   0.997557 135.036306 137.178316  77.672624 140.748333   0.007383 142.686342  0  0  0  0  9216  1
 8 102  1368 1017 493156645.1000   5   4  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.000000  84.513481   0.000000 170.207427   0.066178   0.997557 135.036306 137.163745  77.561390 140.748333   0.007151 142.686342  0  0  0  0  9216  1
 8 102  1824 1017 493156665.1000   5   5  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.000000  84.419766   0.000000 170.236915   0.066178   0.997557 135.036306 137.178316  77.673980 140.762904   0.006509 142.686342  0  0  0  0  9216  1
 8 102  2508 1017 493156677.4550   5   1  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.513481   1.000000 170.207427   0.066178   0.997557 135.036306 137.207459  78.949101 140.704618   0.007218 142.700913  0  0  0  0  9216  2
 8 102  2964 1017 493156697.0500   5   2  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.607197   1.000000 170.222171   0.066178   0.997557 135.050877 137.178316  78.639817 140.748333   0.006668 142.671770  0  0  0  0  9216  2
 8 102  3420 1017 493156717.0500   5   3  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.544720   1.000000 170.207427   0.066178   0.997557 135.036306 137.149173  78.641173 140.762904   0.006601 142.671770  0  0  0  0  9216  2
 8 102  3876 1017 493156737.0500   5   4  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.607197   1.000000 170.207427   0.066178   0.997557 135.036306 137.222031  78.753764 140.704618   0.007065 142.715485  0  0  0  0  9216  2
 8 102  4332 1017 493156757.0500   5   5  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.669674   1.000000 170.222171   0.066178   0.997557 135.050877 137.163745  78.578774 140.748333   0.007206 142.700913  0  0  0  0  9216  2
 8 102  4788 1017 493156769.1400   5   1  0  1   closed  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.669674   1.000000 170.207427   0.066178   0.997557 135.021734 137.178316  79.014214 140.748333   0.007169 142.686342  0  0  0  0  9216  3
 8 102  5244 1017 493156789.0500   5   2  0  1   closed  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.669674   1.000000 170.207427   0.066178   0.997557 134.992591 137.178316  78.725277 140.748333   0.007261 142.686342  0  0  0  0  9216  3
 8 102  5700 1017 493156809.0500   5   3  0  1   closed  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.669674   1.000000 170.207427   0.066178   0.997557 135.007163 137.207459  78.726633 140.777476   0.007187 142.715485  0  0  0  0  9216  3
 8 102  6156 1017 493156829.0500   5   4  0  1   closed  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.607197   1.000000 170.222171   0.066178   0.997557 135.036306 137.163745  78.653382 140.762904   0.006601 142.686342  0  0  0  0  9216  3
 8 102  6612 1017 493156849.0500   5   5  0  1   closed  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.732151   1.000000 170.207427   0.066178   0.997557 135.021734 137.178316  78.722564 140.777476   0.006527 142.700913  0  0  0  0  9216  3
 8 102  6840 1017 493156921.0510   5   1  0  1     open  IR  data_not_compressed  all_spectral_sub-frames  calibration  H_SPE_H_SPA_F   0.500000  84.669674  20.000000 170.310635   0.066178   0.997557 135.021734 137.149173  78.622182 140.748333   0.007200 142.671770  0  0  0  0  9216  4</code></pre>
<p>We have to use these files together to <strong>convert the data in the qub file into radiance and reflectance</strong>. Let&#39;s see now how.</p>
<h2 id="setting_up_the_package"><a href="#setting_up_the_package" class="header-anchor">Setting up the package:</a></h2>
<p>First you have to install the package to install it. For now the package is written for <strong><span style="color: red">IR data</span></strong>. This is quite general so it should work for the visible spectra too. But the detilt function is needed for that, which is not added for now.</p>
<p>To use this package, we have to first install it. For installing here is a bash script &#40;if you want you can just directly download and use from git&#41;,</p>
<pre><code class="language-bash">#&#33;/bin/bash
ENV_DIR&#61;&quot;./virtools-venv&quot;
REPO_URL&#61;&quot;https://github.com/aburousan/virtools.git&quot;
CLONE_DIR&#61;&quot;./virtools&quot;

echo &quot;Creating virtual environment in &#36;ENV_DIR&quot;
python3 -m venv &quot;&#36;ENV_DIR&quot;
source &quot;&#36;ENV_DIR/bin/activate&quot;

pip install --upgrade pip setuptools wheel build

echo &quot;Cloning repo...&quot;
rm -rf &quot;&#36;CLONE_DIR&quot;
git clone &quot;&#36;REPO_URL&quot; &quot;&#36;CLONE_DIR&quot;
cd &quot;&#36;CLONE_DIR&quot; || exit 1
pip install numpy scipy matplotlib scikit-image pvl PyWavelets
python3 -m build
pip install dist/*.whl

echo &quot;virtools installed in virtualenv at &#36;ENV_DIR&quot;
echo &quot;To activate: source &#36;ENV_DIR/bin/activate&quot;</code></pre>
<p>This will create a environment in python and install the package there. For installing in conda, use:</p>
<pre><code class="language-bash">#&#33;/bin/bash

ENV_NAME&#61;&quot;virtools-env&quot;
PYTHON_VERSION&#61;&quot;3.10&quot;
REPO_URL&#61;&quot;https://github.com/aburousan/virtools.git&quot;
CLONE_DIR&#61;&quot;./virtools&quot;

echo &quot;Creating conda environment: &#36;ENV_NAME&quot;
conda create -y -n &quot;&#36;ENV_NAME&quot; python&#61;&#36;PYTHON_VERSION

source &quot;&#36;&#40;conda info --base&#41;/etc/profile.d/conda.sh&quot;
conda activate &quot;&#36;ENV_NAME&quot;

echo &quot;Cloning repo...&quot;
rm -rf &quot;&#36;CLONE_DIR&quot;
git clone &quot;&#36;REPO_URL&quot; &quot;&#36;CLONE_DIR&quot;
cd &quot;&#36;CLONE_DIR&quot; || exit 1

echo &quot;Installing dependencies...&quot;
conda install -y numpy scipy matplotlib scikit-image pip
pip install pvl PyWavelets build

python3 -m build
pip install dist/*.whl

echo &quot;virtools installed in conda env: &#36;ENV_NAME&quot;</code></pre>
<p>Once these two are ran, the package is installed in your system and you can just activate the environment to run the code.</p>
<h2 id="importing_the_data"><a href="#importing_the_data" class="header-anchor">Importing the data:</a></h2>
<p>The data which is recored is stored in fortran format in MSB format. So, while importing we have to correct the endianness and aslo the array type. There are mainly two functions for importing data:</p>
<ol>
<li><p><code>load_qub_from_lbl</code> is a function which takes lbl and qub file names with location. It will load a dictionary of all lbl file data and a numpy array with qun file data. It also returns a mask &#40;depending on the optional argument <code>flag_mask</code>&#41; of the locations of the saturated and nan value pixels.</p>
</li>
<li><p><code>load_qub_from_lbl_name</code> is a function which takes only the base folder and lbl file name. It will then load all four data files &#40;lbl file data as previously, qub file data along with hk.lbl and hk.tab data file&#41;.</p>
</li>
</ol>
<p>Example:</p>
<pre><code class="language-python">File_name_unc &#61; &quot;VIR_IR_1A_1_495681682&quot;
base_folder_name &#61; &quot;/Data/rousan/Ceres_Data/DWNCHVIR_I1A-170324/DWNCHVIR_I1A/DATA/20150816_HAMO/20150909_CYCLE3/&quot;
lbl_file_unc &#61; base_folder_name&#43;File_name_unc&#43;&quot;_1.LBL&quot;
qub_file_unc &#61; base_folder_name&#43;File_name_unc&#43;&quot;_1.QUB&quot;
lbl_hk_file_unc &#61; base_folder_name&#43;File_name_unc&#43;&quot;_HK_1.LBL&quot;
tab_hk_file_unc &#61; base_folder_name&#43;File_name_unc&#43;&quot;_HK_1.TAB&quot;</code></pre>
<p>This are the file names with location. Now pass it to the function:</p>
<pre><code class="language-python">cube_array,lbl_data, flag_mask&#61;load_qub_from_lbl&#40;lbl_file_unc,qub_file_unc,return_flag_mask&#61;True&#41;</code></pre>
<p>The actual data is saved inside the <code>cube_array</code> array. <code>lbl_data</code> contains the meta data. Let&#39;s extract the datas from these python numpy aray and meta-data we will need.</p>
<pre><code class="language-python">bands, samples, lines &#61; lbl_data&#91;&quot;shape&quot;&#93;
wvlen_center &#61; lbl_data&#91;&quot;wave_length_cen&quot;&#93;
wvlen_width &#61; lbl_data&#91;&quot;wave_width&quot;&#93;
wvlen_band_val &#61; lbl_data&#91;&quot;wave_length_band_val&quot;&#93;
exposure_time &#61; lbl_data&#91;&quot;exposure_time&quot;&#93;
spacecraft_solar_dist &#61; lbl_data&#91;&quot;spacecraft_solar_dist&quot;&#93;</code></pre>
<p>Now, we also need the data from house keeping files. For that there are some more functions:</p>
<pre><code class="language-python">hk &#61; extract_hk_data&#40;lbl_hk_file_unc, tab_hk_file_unc&#41;
exposure_times &#61; np.array&#40;hk&#91;&quot;data&quot;&#93;&#91;&quot;exposure_time_ir&quot;&#93;&#41;
ir_temps &#61; np.array&#40;hk&#91;&quot;data&quot;&#93;&#91;&quot;ir_temp&quot;&#93;&#41;
spec_temps &#61; np.array&#40;hk&#91;&quot;data&quot;&#93;&#91;&quot;spect_temp&quot;&#93;&#41;
closed_index &#61; hk&#91;&quot;closed_indexes&quot;&#93;</code></pre>
<p>If we want, we can directly use the other file to import the whole data. <code>wvlen_center</code> contains the wavelength values in \(\mu m\) &amp; <code>wvlen_band_val</code> contains the band values &#40;like eg:\(1,2,3,\cdots,\)&#41;. <code>closed_index</code> is contains the index of the lines for which the shutter was closed, hence giving us the <strong><span style="color: red">dark frames</span></strong>.</p>
<h2 id="calibration"><a href="#calibration" class="header-anchor">Calibration</a></h2>
<p>First thing after importing the data, we need to locate the defective pixels and then interpolate it. I am usingg the spline for that. There is a function for exactly that.</p>
<pre><code class="language-python">cube_def_rem &#61; fix_defective_pixels_with_spline&#40;cube_array,defective_ir_pixels,wvlen_center,FILTER_BANDS_IR&#41;</code></pre>
<p>Here <code>FILTER_BANDS_IR</code> and <code>defective_ir_pixels</code> are numpy arraies which contains the location of filter regions&#40;OSF regions&#41; and detective pixel locations. This gives us an interpolated data. To see the data&#40;image at a specific wavelength/band no.&#41; we have a function called <code>show_band_image</code>.</p>
<pre><code class="language-python">show_band_image&#40;cube_def_rem,200,cbar_label&#61;&quot;DN&quot;&#41;</code></pre>
<p>This gives: 
<div class="row">
  <div class="container">
    <img class="left" src="/assets/Physics/blogs/virtools_blog/image_cra1.png" >
    <div style="clear: both"></div>      
  </div>
</div>
 This contains <strong><span style="color: red">bias</span></strong>,<strong><span style="color: red">dark current</span></strong>,<strong><span style="color: red">thermal background</span></strong> and many other things. Now, we will remove these effects to get the actual signal.</p>
<p>After this to model thermal current, we have to use the dark frames. This will be done by using a function which will detect calibration frames in a folder.</p>
<p><hr /> ‚Äì&gt; ‚Äì&gt;</p>
<p>Hope this helps you in some way. If you like it then share with others if possible.</p>
<p>If you have some queries, do let me know in the comments or contact me using my using the informations that are given on the page <a href="/Pages/about_me/">About Me</a>.</p>

<button onclick="window.history.back()">Go Back</button>


<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = https://rousan.netlify.app/pages/physics/blogs/astronomr_package1/;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://https-rousan-netlify-app.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<div class="page-foot">
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Kazi Abu Rousan. Last modified: August 05, 2025.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>



<!-- Collapsible button example -->
<script>
    var coll = document.getElementsByClassName("collapsible");
    var i;
    
    for (i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.display === "block") {
          content.style.display = "none";
        } else {
          content.style.display = "block";
        }
      });
    }
  </script>
  <!-- End collapsible button example --></div><!-- CONTENT ENDS HERE -->

      </div> <!-- closure of main -->
    </div>   <!-- closure of class initial--content -->

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
        <!-- end custom footer snippets -->
        <div class="page__footer-follow">
          <ul class="social-icons">
            <li><strong>Follow:</strong></li>
            <li><a href="https://twitter.com/AustinRousan" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
            <li><a href="https://github.com/aburousan" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
            <li><a href="https://www.linkedin.com/in/kazi-abu-rousan-819848198/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
            <li><a href="https://www.instagram.com/azavzya/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>


          </ul>
        </div>
        <div class="page__footer-copyright">&copy; Kazi Abu Rousan. Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="/libs/minimal-mistakes/main.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>

    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
        <script src="/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>

    
  </body>
</html>


<script>
  (function(){
  
    // Get the elements.
    // - the 'pre' element.
    // - the 'div' with the 'paste-content' id.
  
    var pre = document.getElementsByTagName('pre');
  
    // Add a copy button in the 'pre' element.
    // which only has the className of 'language-' or ' hljs'(if enable highlight.js pre-render).
  
    for (var i = 0; i < pre.length; i++) {
      var tag_name = pre[i].children[0].className
                var isLanguage = tag_name.startsWith('language-') || tag_name.endsWith(' hljs');
      if ( isLanguage ) {
        var button           = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copy';
  
            pre[i].appendChild(button);
      }
    };
  
    // Run Clipboard
  
    var copyCode = new Clipboard('.copy-button', {
      target: function(trigger) {
        return trigger.previousElementSibling;
      }
    });
  
    // On success:
    // - Change the "Copy" text to "Copied".
    // - Swap it to "Copy" in 2s.
    // - Lead user to the "contenteditable" area with Velocity scroll.
  
    copyCode.on('success', function(event) {
      event.clearSelection();
      event.trigger.textContent = 'Copied';
      window.setTimeout(function() {
        event.trigger.textContent = 'Copy';
      }, 2000);
  
    });
  
    // On error (Safari):
    // - Change the  "Press Ctrl+C to copy"
    // - Swap it to "Copy" in 2s.
  
    copyCode.on('error', function(event) {
      event.trigger.textContent = 'Press "Ctrl + C" to copy';
      window.setTimeout(function() {
        event.trigger.textContent = 'Copy';
      }, 5000);
    });
  
  })();
  </script>